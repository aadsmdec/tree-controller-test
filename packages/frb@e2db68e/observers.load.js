montageDefine("e2db68e","observers",{dependencies:["collections/shim","collections/listen/property-changes","collections/listen/array-changes","collections/sorted-array","collections/sorted-set","collections/map","collections/set","collections/heap","./scope","./operators","./parse","./compile-observer","./merge"],factory:function(e,t){function n(e){return function(t){return t(e)||Function.noop}}function r(e,t){return e(t.value)||Function.noop}function i(e,t){return e(t.parameters)||Function.noop}function a(e){return function(t,n){return t(n.document.getElementById(e))||Function.noop}}function s(e,t){return function(n,r){var i=r.components,a=i.getObjectByLabel||i.getComponentByLabel,s=a.call(i,e);return t.component=s,n(s)||Function.noop}}function o(e,t,n,r){function i(e,t,r){a(),a=n(e,t,r)||Function.noop}if(null==e)return n();var a=Function.noop;return xt.addOwnPropertyChangeListener(e,t,i,r.beforeChange),i(e[t],t,e),wt(function(){a(),xt.removeOwnPropertyChangeListener(e,t,i,r.beforeChange)})}function l(e,t){return function(n,r){return t(Ct(function(t){return"string"!=typeof t&&"number"!=typeof t?n():e(Ct(function(e){return null==e?n():e.observeProperty?e.observeProperty(t,n,r):Pt(e,t,n,r)}),r)}),r)}}function c(e,t,n,r){function i(e,r,i){s(t,r)&&(a(),a=n(e,t,i)||Function.noop)}var a=Function.noop,s=e.contentEquals||Object.equals;return i(e.get(t),t,e),e.addMapChangeListener(i,r.beforeChange),wt(function(){a(),e.removeMapChangeListener(i)})}function u(e,t){return function(n,r){return e(Ct(function(e){return e?t(Ct(function(t){return null==t?n():e.observeGet?e.observeGet(t,n,r):Ot(e,t,n,r)}),r):n()}),r)}}function h(e,t){return function(n,r){return n=yt(n),t(Ct(function(t){return e(Ct(function(e){return e?J(e,function(){return n((e.has||e.contains).call(e,t))},r):n()}),r)}),r)}}function d(e){return function(t,n){for(var r=Array(e.length),i=0;e.length>i;i++)r[i]=void 0;var a=e.map(function(e,t){return e(function(e){r.set(t,e)},n)}),s=t(r)||Function.noop;return wt(function(){s(),Lt(a)})}}function p(e){return function(t,n){var r={},i={};for(var a in e)(function(e,t){r[e]=t(function(t){i[e]=t},n)})(a,e[a]);var s=t(i)||Function.noop;return function(){s();for(var e in r)r[e]()}}}function m(){return d(Array.prototype.slice.call(arguments))}function g(e){return function(){var t=d(Array.prototype.slice.call(arguments)),n=it(t);return function(t,r){return n(Ct(function(n){return n.every(Tt.defined)?t(e.apply(void 0,n)):t()}),r)}}}function f(e){var t=e.slice(0,1).toUpperCase()+e.slice(1),n="make"+t+"Observer",r="observe"+t;return function(){var t=arguments[0],i=Array.prototype.slice.call(arguments,1),a=i.map(function(e){return function(t,n){return e(Ct(t),n)}}),s=d(i),o=it(s);return function(i,s){return t(Ct(function(t){return t?t[n]?t[n].apply(t,a)(i,s):t[r]?t[r](i,s):o(Ct(function(n){return n.every(Tt.defined)?"function"==typeof t[e]?i(t[e].apply(t,n)):i():i()}),s):i()}),s)}}}function v(e){return function(t,n){return e(Ct(function(e){return t(!e)}),n)}}function _(e,t){return function(n,r){return e(Ct(function(e){return e?t(n,r):n(e)}),r)}}function b(e,t){return function(n,r){return e(Ct(function(e){return e?n(e):t(n,r)}),r)}}function y(e,t,n){return function(r,i){return e(Ct(function(e){return null==e?r():e?t(r,i):n(r,i)}),i)}}function L(e){return function(t,n){return e(Ct(function(e){return t(null!=e)}),n)}}function C(e,t){return function(n,r){return e(Ct(function(e){return null==e?t(n,r):n(e)}),r)}}function w(e,t){return function(n,r){return e(Ct(function(e){function i(t){for(;e.length>t;t++)o[t].index=t}function a(e,n,a){o.swap(a,n.length,e.map(function(e,t){return{index:a+t}})),i(a+e.length);var c,u=[];Lt(l.swap(a,n.length,e.map(function(e,n){var i=o[a+n];return t(Ct(function(e){c?s.set(i.index,e):u[n]=e}),r.nest(e))}))),c=!0,s.swap(a,n.length,u)}if(!e)return n();var s=[],o=[],l=[],c=J(e,a,r),u=n(s,e)||Function.noop;return wt(function(){u(),Lt(l),c()})}),r)}}function x(e,t){var n=w(e,t);return function(e,t){return n(Ct(function(n,r){function i(e){for(;n.length>e;e++)l[e+1]=l[e]+!!n[e]}function a(e,t,n){var a=r.slice(n,n+e.length),o=t.map(Boolean).sum(),c=a.filter(function(t,n){return e[n]}),u=l[n],h=s.slice(u,u+o);(h.length!==c.length||h.some(function(e,t){return e!==c[t]}))&&s.swap(u,o,c),i(u)}if(!r)return e();var s=[],o=[],l=[0],c=J(n,a,t),u=e(s)||Function.noop;return wt(function(){u(),Lt(o),c()})}),t)}}function M(e,t){var n=S(t),r=w(e,n),i=function(e,t){return r(Ct(function(n){function r(e,t){a.addEach(e),a.deleteEach(t)}if(!n)return e();var i=[],a=Mt(i,z,E),s=J(n,r,t),o=e(i)||Function.noop;return function(){o(),s()}}),t)};return Dt(i,ut)}function z(e,t){return Object.equals(e[1],t[1])}function E(e,t){return Object.compare(e[1],t[1])}function S(e){return function(t,n){return e(Ct(function(e){return t([n.value,e])||Function.noop}),n)}}function T(e,t){var n=S(t),r=w(e,n),i=B(r,dt),a=w(i,$(dt));return function(e,t){function n(e,t){return e=o.get(e),t=o.get(t),Object.compare(e,t)}function r(e,t){return e=o.get(e),t=o.get(t),Object.equals(e,t)}function i(e,t){t.forEach(function(e){l["delete"](e[0]),o["delete"](e[0])}),e.forEach(function(e){o.set(e[0],e[1]),l.add(e[0])})}function s(e){return l.clear(),J(e,i,t)}var o=new Et,l=new zt(null,r,n),c=e(l)||Function.noop,u=a(s,t);return function(){c(),u()}}}function P(e){return function(t,n){return e(Ct(function(e){function r(e,t,n){var r=i.length-n-t.length;i.swap(r,t.length,e.reversed())}if(!e)return t();var i=[],a=J(e,r,n),s=t(i);return wt(function(){s(),a()})}),n)}}function O(e){return function(t,n){return e(Ct(function(e){function r(t){for(var n=t;e.length>n;n++)l[n].index=n,o[n+1]=e[n]?o[n]+e[n].length:o[n]}function i(e,t,i){var c=o[i],u=o[i+t.length],h=u-c;a.swap(c,h,[]),l.swap(i,t.length,e.map(function(){return{index:null}})),r(i),Lt(s.swap(i,t.length,e.map(function(e,t){function s(e,t,n){r(c.index);var i=o[c.index]+n,s=o[c.index]+n+t.length,l=s-i;a.swap(i,l,e)}var c=l[i+t];return J(e,s,n)})))}if(!e)return t();var a=[],s=[],o=[0],l=[],c=J(e,i,n),u=t(a)||Function.noop;return wt(function(){u(),Lt(s),c()})}),n)}}function D(){return At(d(Array.prototype.slice.call(arguments)))}function k(e,t){var n=kt(e,t),r=l(n,Bt);return gt(r,Boolean)}function A(e,t){var n=gt(t,Tt.not),r=kt(e,n),i=l(r,Bt);return gt(i,Tt.not)}function B(e,t){var n=j(e,t);return Nt(n)}function j(e,t){var n=S(t),r=w(e,n);return function(e,t){return r(Ct(function(n,r){function i(e,t){t.forEach(function(e){var t=a.get(e[1]);1===t.length?a["delete"](e[1]):t["delete"](e[0])}),e.forEach(function(e){var t,n=!a.has(e[1]);t=n?r.constructClone():a.get(e[1]),t.add(e[0]),n&&a.set(e[1],t)})}if(!n)return e();var a=Et(),s=J(n,i,t),o=e(a)||Function.noop;return function(){s(),o()}}),t)}}function I(e,t,n){function r(e,t){return Object.compare(e[1],t[1])*n}var i=S(t),a=w(e,i);return function(e,t){return a(Ct(function(n){function i(e,t){s.addEach(e),s.deleteEach(t)}function a(t,n){return 0===n?t?e(t[0]):e():void 0}if(!n)return e();var s=new St(null,z,r),o=J(n,i,t),l=st(s,a,t);return function(){o(),l()}}),t)}}function R(e,t){return I(e,t,1)}function N(e,t){return I(e,t,-1)}function F(e){return I(e,r,1)}function q(e){return I(e,r,-1)}function U(e){return function(t){return function(n,r){return n=yt(n),t(Ct(function(t){if(!t)return n();var i=e(t,n);return J(t,function(e,t,r){return n(i(e,t,r))},r)}),r)}}}function V(e){return"number"==typeof e&&!isNaN(e)}function W(e,t,n){return n||(n=t,t=jt),function(r,i){return e(Ct(function(e){function a(t,n,r){if(h){var i=t.length-n.length;o>=r?i>0?(u.swap(0,0,e.slice(o,o+i)),u.splice(s,u.length-s)):(u.splice(0,-i),u.swap(u.length,0,e.slice(o+u.length,o+s))):o+s>r&&(u.swap(r-o,n.length,t),i>0?u.splice(s,u.length-s):u.swap(u.length,0,e.slice(o+u.length,o+s)))}}if(!e)return r();var s,o,l,c,u=[],h=!1,d=J(e,a,i),p=n(function(t){t=+t,isNaN(t)&&(t=void 0);var n="number"==typeof t&&"number"==typeof o,r=Math.max(0,t);"number"==typeof c&&(r=Math.min(r,e.length-c)),h!==n?(n?u.swap(0,0,e.slice(c,c+r)):u.clear(),h=n):h&&l!==r&&(l>r?u.splice(t,l-r):u.swap(l,0,e.slice(c+l,c+r))),s=t,l=r},i),m=t(function(t){t=+t,isNaN(t)&&(t=void 0);var n="number"==typeof s&&"number"==typeof t,r=Math.max(0,t);"number"==typeof s&&(r=Math.min(r,e.length));var i=Math.max(0,s);if("number"==typeof r&&(i=Math.min(i,e.length-r)),h!==n)n?u.swap(0,u.length,e.slice(r,r+i)):u.clear(),h=n;else if(h&&c!==r){var a=Math.abs(r-c);l>a&&c>r?(u.swap(0,0,e.slice(r,c)),u.splice(i,u.length-i)):l>a&&r>c?(u.swap(u.length,0,e.slice(c+l,r+i)),u.splice(0,u.length-i)):u.swap(0,u.length,e.slice(r,r+i))}o=t,c=r,l=i},i),g=r(u)||Function.noop;return function(){g(),p(),m(),d()}}),i)}}function Y(e){return function(t,n){return e(Ct(function(e){function r(e){for(;a.length>e;e++)a[e].set(0,e)}function i(e,t,n){a.swap(n,t.length,e.map(function(e,t){return[n+t,e]})),r(n+e.length)}if(!e)return t();var a=[],s=J(e,i,n),o=t(a)||Function.noop;return function(){o(),s()}}),n)}}function H(e){return function(t,n){var r=[],i=t(r)||Function.noop,a=e(function(e){if(e>>>=0,null==e)r.clear();else if(e>r.length){for(var t=[],n=r.length;e>n;n++)t.push(n);r.swap(r.length,0,t)}else r.length>e&&r.splice(e,r.length)},n);return function(){i(),a()}}}function K(e,t){return function(n,r){return t(function(t){var i=RegExp("^"+RegExp.escape(t));return e(function(e){return n(i.test(e))||Function.noop},r)},r)}}function X(e,t){return function(n,r){return t(function(t){var i=RegExp(RegExp.escape(t)+"$");return e(function(e){return n(i.test(e))||Function.noop},r)},r)}}function G(e,t){return function(n,r){return t(function(t){var i=RegExp(RegExp.escape(t));return e(function(e){return n(i.test(e))||Function.noop},r)},r)}}function Z(e,t){return t=t||It,function(n,r){return e(Ct(function(e){return e?t(Ct(function(t){function i(){a=n(e.join(t))||Function.noop}if("string"!=typeof t)return n()||Function.noop;var a=Function.noop,s=J(e,i,r);return function(){s(),a()}}),r):n()||Function.noop}),r)}}function J(e,t,n){function r(e,n,r){i(),i=t(e,n,r)||Function.noop}if(!e)return Function.noop;var i=Function.noop;if(!e.toArray)return Function.noop;if(!e.addRangeChangeListener)return Function.noop;r(e.toArray(),[],0);var a=e.addRangeChangeListener(r,null,n.beforeChange);return function(){i(),a()}}function $(e){return function(t,n){return e(Ct(function(e){return Rt(e,t,n)}),n)}}function Q(e,t,n){function r(n,r,o){if(i+=n.length-r.length,!(i>o+r.length&&i>o+n.length)){var l=0>i?null:e.get(i);a(),a=t(l)||Function.noop,s=l}}var i=-1,a=Function.noop,s=null,o=J(e,r,n);return function(){a(),o()}}function et(e){return function(t,n){return e(Ct(yt(function(e){return tt(e,t,n)})),n)}}function tt(e,t,n){function r(n,r){return i+=n.length-r.length,1===i?t(e.only()):t()}var i=0;return J(e,r,n)}function nt(e){return function(t,n){return e(Ct(yt(function(e){return rt(e,t,n)})),n)}}function rt(e,t,n){function r(n,r){return i+=n.length-r.length,i>0?t(e.one()):t()}var i=0;return J(e,r,n)}function it(e){return function(t,n){return e(Ct(function(e){return e&&e.addRangeChangeListener?J(e,function(){return t(e)},n):t(e)}),n)}}function at(e){return function(t,n){return e(Ct(function(e){return e&&e.addMapChangeListener?st(e,function(){return t(e)},n):t(e)}),n)}}function st(e,t,n){function r(e,n,r){var a=i.get(n)||Function.noop;i["delete"](n),a(),a=t(e,n,r)||Function.noop,void 0===e?a():i.set(n,a)}if(e.addMapChangeListener){var i=new Et;e.forEach(r);var a=e.addMapChangeListener(r,n.beforeChange);return wt(function(){i.forEach(function(e){e()}),a()})}}function ot(e){return function(t,n){return e(Ct(function(e){return e?lt(e,t,n):t()}),n)}}function lt(e,t,n){function r(e,t){var n,r;a.has(t)?null==e?(n=a.get(t),a["delete"](t),r=i.indexOf(n),i.splice(r,1)):(n=a.get(t),n.set(1,e)):(n=[t,e],a.set(t,n),i.push(n))}var i=[],a=Et(),s=t(i)||Function.noop,o=st(e,r,n)||Function.noop;return wt(function(){s(),o()})}function ct(e){var t=Nt(e);return Dt(t,ut)}function ut(e,t){return t.value?e(t.value[0])||Function.noop:e()}function ht(e){var t=Nt(e);return Dt(t,dt)}function dt(e,t){return t.value?e(t.value[1])||Function.noop:e()}function pt(e){return function(t,n){var r=new Et,i=t(r)||Function.noop,a=e(Ct(function(e){function t(e,t){void 0===e?r["delete"](t):r.set(t,e)}if(r.clear(),e&&"object"==typeof e){if(e.addRangeChangeListener)return Ft(Ct(function(e){function t(e,t){t.forEach(function(e){r["delete"](e[0])}),e.forEach(function(e){r.set(e[0],e[1])})}return J(e,t,n)}),n.nest(e));if(e.addMapChangeListener)return st(e,t,n);var i=Object.keys(e).map(function(t){return Pt(e,t,Ct(function(e){void 0===e?r["delete"](t):r.set(t,e)}),n)});return function(){Lt(i)}}}),n);return function(){i(),a()}}}function mt(e){return function(t,n){return e(t,n.parent||n.nest())}}function gt(e,t,n){return function(r,i){return r=yt(r),e(Ct(function(e){return r(t.call(n,e))}),i)}}function ft(e,t,n){return function(r,i){return r=yt(r),e(Ct(function(e){return e&&e.every(Tt.defined)?r(t.apply(n,e)):void 0}),i)}}function vt(t,n){var r=e("./parse"),i=e("./compile-observer");return function(e,a){return e=yt(e),n(Ct(function(n){if(null==n)return e();var s,o;try{s=r(n),o=i(s)}catch(l){return e()}return t(Ct(function(t){return o(e,a.nest(t))}),a)}),a)}}function _t(e,t){return function(n,r){return e(Ct(function(e){return t(Ct(function(e){return n(e)}),r.nest(e))}),r)}}function bt(e){return function(){var t=e.apply(this,arguments);return function(e,n){var r=[],i=t(Ct(function(e){function t(e,t,n){r.swap(n,t.length,e)}if(e){qt(r,e);var i=e.addRangeChangeListener(t,null,n.beforeChange);return wt(i)}r.clear()}),n),a=e(r)||Function.noop;return wt(function(){i(),a()})}}}function yt(e){var t;return function(n){if(n!==t){var r=e.apply(this,arguments);return t=n,r}}}function Lt(e){e.forEach(function(e){e&&e()})}function Ct(e){var t=Function.noop;return function(){return t(),t=e.apply(this,arguments)||Function.noop,function(){t()}}}function wt(e){var t;return function(){return t?Function.noop:(t=!0,e.apply(this,arguments))}}e("collections/shim");var xt=e("collections/listen/property-changes");e("collections/listen/array-changes");var Mt=e("collections/sorted-array"),zt=e("collections/sorted-set"),Et=e("collections/map");e("collections/set");var St=e("collections/heap");e("./scope");var Tt=e("./operators");t.makeLiteralObserver=n,t.observeValue=r,t.observeParameters=i,t.makeElementObserver=a,t.makeComponentObserver=s,t.observeProperty=o;var Pt=o;t.makePropertyObserver=l,t.observeKey=c,t.observeGet=c;var Ot=c;t.makeGetObserver=u,t.makeHasObserver=h,t.makeObserversObserver=d,t.makeRecordObserver=p,t.makeObjectObserver=p,t.makeTupleObserver=m,t.makeArrayObserver=m,t.makeOperatorObserverMaker=g,t.makeMethodObserverMaker=f,t.makeNotObserver=v,t.makeAndObserver=_,t.makeOrObserver=b,t.makeConditionalObserver=y,t.makeDefinedObserver=L,t.makeDefaultObserver=C;var Dt=t.makeMapBlockObserver=bt(w),kt=t.makeFilterBlockObserver=bt(x);t.makeSortedBlockObserver=M,t.makeSortedSetBlockObserver=T,t.makeReversedObserver=bt(P);var At=t.makeFlattenObserver=bt(O);t.makeConcatObserver=D,t.makeSomeBlockObserver=k,t.makeEveryBlockObserver=A,t.makeGroupBlockObserver=B,t.makeGroupMapBlockObserver=j,t.makeMaxBlockObserver=R,t.makeMinBlockObserver=N,t.makeMaxObserver=F,t.makeMinObserver=q;var Bt=n("length");t.makeSumObserver=U(function(){var e=0;return function(t,n){return t=t.filter(V),n=n.filter(V),e+=t.sum()-n.sum()}}),t.makeAverageObserver=U(function(){var e=0,t=0;return function(n,r){return n=n.filter(V),r=r.filter(V),e+=n.sum()-r.sum(),t+=n.length-r.length,e/t}}),t.makeViewObserver=bt(W);var jt=n(0);t.makeEnumerateObserver=bt(Y),t.makeEnumerationObserver=t.makeEnumerateObserver,t.makeRangeObserver=H,t.makeStartsWithObserver=K,t.makeEndsWithObserver=X,t.makeContainsObserver=G,t.makeJoinObserver=Z;var It=n("");t.observeRangeChange=J,t.makeLastObserver=$,t.observeLast=Q;var Rt=Q;t.makeOnlyObserver=et,t.observeOnly=tt,t.makeOneObserver=nt,t.observeOne=rt,t.makeRangeContentObserver=it,t.makeMapContentObserver=at,t.observeMapChange=st;var Nt=t.makeEntriesObserver=bt(ot);t.observeEntries=lt,t.makeKeysObserver=ct,t.observeEntryKey=ut,t.makeValuesObserver=ht,t.observeEntryValue=dt,t.makeToMapObserver=pt;var Ft=Dt(B(r,ut),$(dt));t.makeParentObserver=mt,t.makeConverterObserver=gt,t.makeComputerObserver=ft,t.makePathObserver=vt,t.makeExpressionObserver=vt,t.makeWithObserver=_t,t.makeToArrayObserver=bt(Function.identity),t.makeAsArrayObserver=t.makeToArrayObserver;var qt=e("./merge").merge;t.makeUniq=yt,t.cancelEach=Lt,t.autoCancelPrevious=Ct,t.once=wt}});